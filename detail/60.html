<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>

<!-- Mirrored from blog.dev.3d66.com/detail/60.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 08 Jul 2025 08:22:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<title>Thinkphp3.2 PHPexcel 导出 - 小罗博客</title>
	<link href="../public/Home/css/bootstrap.css" rel='stylesheet' type='text/css' />
	<link href="../public/Home/css/style.css" rel='stylesheet' type='text/css' />
	<link href="../public/Home/css/base.css" rel='stylesheet' type='text/css' />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="Thinkphp3.2 PHPexcel 导出 - Thinkphp3.2 PHPexcel 导出 - 小罗博客" />
	<meta name="description" content="Thinkphp3.2 PHPexcel 导出 - Thinkphp3.2 PHPexcel 导出 - 小罗博客" />
	<!----webfonts---->
		<!----//webfonts---->
		  <script src="../public/Home/js/jquery.min.js"></script>
		<!--end slider -->
		<!--script-->
<!--/script-->
<script type="text/javascript">
			jQuery(document).ready(function($) {
				$(".scroll").click(function(event){		
					event.preventDefault();
					$('html,body').animate({scrollTop:$(this.hash).offset().top},900);
				});
			});
</script>
<!---->

</head>
<body>
<!---header---->			
<div class="header">  
	<div class="header_top">
		<div class="container">
			<div class="header_top_l">
				<p>Hi！欢迎来到 <span class="author">咖啡屋的少年（小罗）</span> 的博客<span class="qq_group">技术交流QQ群：上海php（592152335）、代码改变世界（453011886）</span></p>
			</div>
			<div class="header_top_r">
				<!-- <p>
					<a href="/login.html">登录</a>
					<a href="/register.html">注册</a>
				</p> -->
			</div>
		</div>
	</div>
	 <div class="container" style="margin-bottom:20px">
		  <div class="logo">
			  <a href="index.html"><img src="../public/Home/images/logo.png" title="" /></a>
		  </div>
			 <!---start-top-nav---->
			 <div class="top-menu">
				 
				  <span class="menu"> </span>
				   <ul>
						<li class="active"><a href="../index.html">首页</a></li>
						<li ><a href="../list/PHP.html">PHP</a></li>
						<li ><a href="../list/HTML.html">前端</a></li>
						<li ><a href="../list/linux.html">Linux</a></li>
						<li ><a href="../list/Seo.html">SEO</a></li>
						<li ><a href="../list/mysql.html">MySql</a></li>
						<li ><a href="../list/redis.html">Redis</a></li>
						<li ><a href="../list/Other.html">其他</a></li>
						<div class="clearfix"> </div>
				 </ul>
			 </div>
			 <div class="clearfix"></div>
					<script>
					$("span.menu").click(function(){
						$(".top-menu ul").slideToggle("slow" , function(){
						});
					});
					</script>
				<!---//End-top-nav---->					
	 </div>
</div>

    
<!--/header-->
<div class="content">
	 <div class="container">
		 <div class="content-grids">
			 <div class="col-md-8 content-main">
				 <div class="content-grid">
				 	<h4 class="detail-title">Thinkphp3.2 PHPexcel 导出</h4>
				 	<div class="detail-time">
				 		<p class="post-info-time">2017-09-16 13:14:24 <span>依然范儿特西</span>阅读(0) <span>点赞(0)</span> <span>评论(0)</span></p>
				 	</div>
				 					 		<p class="reprint">本文为转载文章，如有侵权，请联系博主。原文链接：<a href="http://www.cnblogs.com/richerdyoung/p/6603977.html" target="_black">http://www.cnblogs.com/richerdyoung/p/6603977.html</a></p>
				 						<div class="detail_div">
						<p>1 &#x4E0B;&#x8F7D;phpexecl &#xA0;&#x653E;&#x5165;&#x5230;tp&#x91CC;&#x8FB9;&#x3002;</p>
<p>&#x8DEF;&#x5F84;&#x5982;&#x4E0B;&#xFF1A;&#x9879;&#x76EE;&#x6839;&#x76EE;&#x5F55;\ThinkPHP\Library\Org\Util</p>
<p><img src="../../images2015.cnblogs.com/blog/1103071/201703/1103071-20170323105151455-879862762.html" alt=""></p>
<p>&#xA0;</p>
<p>2 &#xA0;PHP &#x4EE3;&#x7801;&#x90E8;&#x5206;&#xA0;</p>
<p>&#x5C01;&#x88C5;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">private</span>  <span style="color: #0000ff">function</span> getExcel(<span style="color: #800080">$fileName</span>,<span style="color: #800080">$headArr</span>,<span style="color: #800080">$data</span><span style="color: #000000">){
        </span><span style="color: #008000">//</span><span style="color: #008000">&#x5BFC;&#x5165;PHPExcel&#x7C7B;&#x5E93;&#xFF0C;&#x56E0;&#x4E3A;PHPExcel&#x6CA1;&#x6709;&#x7528;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x53EA;&#x80FD;inport&#x5BFC;&#x5165;</span>
        import(&quot;Org.Util.PHPExcel&quot;<span style="color: #000000">);
        import(</span>&quot;Org.Util.PHPExcel.Writer.Excel5&quot;<span style="color: #000000">);
        import(</span>&quot;Org.Util.PHPExcel.IOFactory.php&quot;<span style="color: #000000">);

        </span><span style="color: #800080">$date</span> = <span style="color: #008080">date</span>(&quot;Y_m_d&quot;,<span style="color: #008080">time</span><span style="color: #000000">());
        </span><span style="color: #800080">$fileName</span> .= &quot;_{<span style="color: #800080">$date</span>}.xls&quot;<span style="color: #000000">;

        </span><span style="color: #008000">//</span><span style="color: #008000">&#x521B;&#x5EFA;PHPExcel&#x5BF9;&#x8C61;&#xFF0C;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x80FD;&#x5C11;&#x4E86;\</span>
        <span style="color: #800080">$objPHPExcel</span> = <span style="color: #0000ff">new</span><span style="color: #000000"> \PHPExcel();
        </span><span style="color: #800080">$objProps</span> = <span style="color: #800080">$objPHPExcel</span>-&gt;<span style="color: #000000">getProperties();

        </span><span style="color: #008000">//</span><span style="color: #008000">&#x8BBE;&#x7F6E;&#x8868;&#x5934;</span>
        <span style="color: #800080">$key</span> = <span style="color: #008080">ord</span>(&quot;A&quot;<span style="color: #000000">);
        </span><span style="color: #008000">//</span><span style="color: #008000">print_r($headArr);exit;</span>
        <span style="color: #0000ff">foreach</span>(<span style="color: #800080">$headArr</span> <span style="color: #0000ff">as</span> <span style="color: #800080">$v</span><span style="color: #000000">){
            </span><span style="color: #800080">$colum</span> = <span style="color: #008080">chr</span>(<span style="color: #800080">$key</span><span style="color: #000000">);
            </span><span style="color: #800080">$objPHPExcel</span>-&gt;setActiveSheetIndex(0) -&gt;setCellValue(<span style="color: #800080">$colum</span>.&apos;1&apos;, <span style="color: #800080">$v</span><span style="color: #000000">);

            </span><span style="color: #800080">$objPHPExcel</span>-&gt;setActiveSheetIndex(0) -&gt;setCellValue(<span style="color: #800080">$colum</span>.&apos;1&apos;, <span style="color: #800080">$v</span><span style="color: #000000">);
            </span><span style="color: #800080">$key</span> += 1<span style="color: #000000">;
        }

        </span><span style="color: #800080">$column</span> = 2<span style="color: #000000">;
        </span><span style="color: #800080">$objActSheet</span> = <span style="color: #800080">$objPHPExcel</span>-&gt;<span style="color: #000000">getActiveSheet();

        </span><span style="color: #008000">//</span><span style="color: #008000">print_r($data);exit;</span>
        <span style="color: #0000ff">foreach</span>(<span style="color: #800080">$data</span> <span style="color: #0000ff">as</span> <span style="color: #800080">$key</span> =&gt; <span style="color: #800080">$rows</span>){ <span style="color: #008000">//</span><span style="color: #008000">&#x884C;&#x5199;&#x5165;</span>
            <span style="color: #800080">$span</span> = <span style="color: #008080">ord</span>(&quot;A&quot;<span style="color: #000000">);
            </span><span style="color: #0000ff">foreach</span>(<span style="color: #800080">$rows</span> <span style="color: #0000ff">as</span> <span style="color: #800080">$keyName</span>=&gt;<span style="color: #800080">$value</span>){<span style="color: #008000">//</span><span style="color: #008000"> &#x5217;&#x5199;&#x5165;</span>
                <span style="color: #800080">$j</span> = <span style="color: #008080">chr</span>(<span style="color: #800080">$span</span><span style="color: #000000">);
                </span><span style="color: #800080">$objActSheet</span>-&gt;setCellValue(<span style="color: #800080">$j</span>.<span style="color: #800080">$column</span>, <span style="color: #800080">$value</span><span style="color: #000000">);
                </span><span style="color: #800080">$span</span>++<span style="color: #000000">;
            }
            </span><span style="color: #800080">$column</span>++<span style="color: #000000">;
        }

        </span><span style="color: #800080">$fileName</span> = <span style="color: #008080">iconv</span>(&quot;utf-8&quot;, &quot;gb2312&quot;, <span style="color: #800080">$fileName</span><span style="color: #000000">);

        </span><span style="color: #008000">//</span><span style="color: #008000">&#x91CD;&#x547D;&#x540D;&#x8868;
        //$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(&apos;test&apos;);
        //&#x8BBE;&#x7F6E;&#x6D3B;&#x52A8;&#x5355;&#x6307;&#x6570;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x8868;,&#x6240;&#x4EE5;Excel&#x6253;&#x5F00;&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x8868;</span>
        <span style="color: #800080">$objPHPExcel</span>-&gt;setActiveSheetIndex(0<span style="color: #000000">);
        </span><span style="color: #008080">ob_end_clean</span>();<span style="color: #008000">//</span><span style="color: #008000">&#x6E05;&#x9664;&#x7F13;&#x51B2;&#x533A;,&#x907F;&#x514D;&#x4E71;&#x7801;</span>
        <span style="color: #008080">header</span>(&apos;Content-Type: application/vnd.ms-excel&apos;<span style="color: #000000">);
        </span><span style="color: #008080">header</span>(&quot;Content-Disposition: attachment;filename=\&quot;<span style="color: #800080">$fileName</span>\&quot;&quot;<span style="color: #000000">);
        </span><span style="color: #008080">header</span>(&apos;Cache-Control: max-age=0&apos;<span style="color: #000000">);

        </span><span style="color: #800080">$objWriter</span> = \PHPExcel_IOFactory::createWriter(<span style="color: #800080">$objPHPExcel</span>, &apos;Excel5&apos;<span style="color: #000000">);
        </span><span style="color: #800080">$objWriter</span>-&gt;save(&apos;php://output&apos;); <span style="color: #008000">//</span><span style="color: #008000">&#x6587;&#x4EF6;&#x901A;&#x8FC7;&#x6D4F;&#x89C8;&#x5668;&#x4E0B;&#x8F7D;</span>
        <span style="color: #0000ff">exit</span><span style="color: #000000">;
    }</span></pre>
</div>
<p>&#xA0;</p>
<p>&#xA0;&#x6570;&#x636E;&#x5BFC;&#x51FA;&#x65B9;&#x6CD5;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">function</span><span style="color: #000000"> index(){</span>
    <span style="color: #800080">$user</span>=M(&apos;table&apos;<span style="color: #000000">);
    </span><span style="color: #800080">$data</span>=<span style="color: #800080">$user</span>-&gt;<span style="color: #000000">select();
    </span><span style="color: #0000ff">foreach</span> (<span style="color: #800080">$data</span> <span style="color: #0000ff">as</span> <span style="color: #800080">$key</span> =&gt; <span style="color: #800080">$value</span><span style="color: #000000">) {
        </span><span style="color: #800080">$data</span>[<span style="color: #800080">$key</span>][id]=<span style="color: #800080">$value</span>[&apos;id&apos;<span style="color: #000000">];
        </span><span style="color: #800080">$data</span>[<span style="color: #800080">$key</span>][name]=<span style="color: #800080">$value</span>[&apos;name&apos;<span style="color: #000000">];
        </span><span style="color: #800080">$data</span>[<span style="color: #800080">$key</span>][sex]=<span style="color: #800080">$value</span>[&apos;sex&apos;<span style="color: #000000">];
        </span><span style="color: #800080">$data</span>[<span style="color: #800080">$key</span>][content]=<span style="color: #800080">$value</span>[&apos;content&apos;<span style="color: #000000">];
    }
    </span><span style="color: #0000ff">foreach</span> (<span style="color: #800080">$data</span> <span style="color: #0000ff">as</span> <span style="color: #800080">$filed</span> =&gt; <span style="color: #800080">$value</span><span style="color: #000000">) {
       </span><span style="color: #0000ff">if</span>(<span style="color: #800080">$filed</span>== &apos;id&apos;){<span style="color: #800080">$headArr</span>[]=&apos;&#x5E8F;&#x53F7;&apos;<span style="color: #000000">;}
       </span><span style="color: #0000ff">if</span>(<span style="color: #800080">$filed</span>== &apos;name&apos;){<span style="color: #800080">$headArr</span>[]=&apos;&#x540D;&#x5B57;&apos;<span style="color: #000000">;}
       </span><span style="color: #0000ff">if</span>(<span style="color: #800080">$filed</span>== &apos;sex&apos;){<span style="color: #800080">$headArr</span>[]=&apos;&#x6027;&#x522B;&apos;<span style="color: #000000">;}
       </span><span style="color: #0000ff">if</span>(<span style="color: #800080">$filed</span>== &apos;content&apos;){<span style="color: #800080">$headArr</span>[]=&apos;&#x5907;&#x6CE8;&apos;<span style="color: #000000">;}
   }
        
   </span><span style="color: #800080">$filename</span>=&quot;&#x6D4B;&#x8BD5;&quot;;  <span style="color: #008000">//</span><span style="color: #008000">&#x6587;&#x4EF6;&#x540D;&#x5B57;</span>
   <span style="color: #800080">$this</span>-&gt;getExcel(<span style="color: #800080">$filename</span>,<span style="color: #800080">$headArr</span>,<span style="color: #800080">$data</span><span style="color: #000000">); 
  
    }</span></pre>
</div>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>3 &#x8BBF;&#x95EE;index&#x65B9;&#x6CD5; &#xA0; ok&#x4E86;&#xFF01;</p>					</div> 
				 </div>
			  </div>
			<div class="col-md-4 content-right">
			  	 <div class="recent">
					 <h3>站内搜索</h3>
					 <div class="search">
						 <form action="http://blog.dev.3d66.com/search.html" method="get">
						 <input type="text" name="keywords" placeholder="请输入关键字" required="">
						 <input type="submit" value=""/>
						 </form>
					 </div>
				 </div>
				 <div class="recent">
					 <h3>热门文章</h3>
					 <ul>
													<li><a href="1.html">【go】用Golang的 http 包建立 Web 服务器</a></li>
													<li><a href="2.html">【go】go语言socket通信样例</a></li>
													<li><a href="3.html">【linux】Centos下登陆mysql报错#1045 - A</a></li>
													<li><a href="4.html">【Linux】 ftp  主动被动模式</a></li>
													<li><a href="5.html">【linux】安装rar，并解压被压缩成多个rar的文件</a></li>
													<li><a href="7.html">【Redis】php+redis实现消息队列</a></li>
													<li><a href="9.html">【PHP】 php实现字符串反转：支持中英文</a></li>
													<li><a href="11.html">【Laravel】Mac下玩转Laravel</a></li>
													<li><a href="12.html">【PHP】 判断是否微信内置浏览器</a></li>
													<li><a href="13.html">【Base64】用 js 编 解 码 base64</a></li>
											 </ul>
				 </div>
				 <div class="recent">
					 <h3>推荐文章</h3>
					 <ul>
					 								<li><a href="1.html">【go】用Golang的 http 包建立 Web 服务器</a></li>
													<li><a href="2.html">【go】go语言socket通信样例</a></li>
													<li><a href="3.html">【linux】Centos下登陆mysql报错#1045 - A</a></li>
													<li><a href="5.html">【linux】安装rar，并解压被压缩成多个rar的文件</a></li>
													<li><a href="6.html">【Linux】WinSCP普通用户登录sftp后切换到root权</a></li>
													<li><a href="8.html">【mysql】mysql front 提示Access viol</a></li>
													<li><a href="10.html">【短信接口】阿里大于迁移到阿里云之后使用方法</a></li>
													<li><a href="12.html">【PHP】 判断是否微信内置浏览器</a></li>
													<li><a href="14.html">【ecshop】调用购物车商品数量</a></li>
													<li><a href="16.html">【Twitter接口】网站嵌入推特信息</a></li>
											 </ul>
				 </div>
				 <div class="recent">
					 <h3>友情链接</h3>
					 <ul>
						<li><a href="https://www.zhaorui.info/" target="_blank">肇锐博客</a></li>
						<li><a href="https://www.fujieace.com/" target="_blank">付杰博客</a></li>
						<li><a href="http://www.cnblogs.com/richerdyoung/" target="_blank">依然范儿特西博客</a></li>
					 </ul>
				 </div>
				 <div class="clearfix"></div>
			  </div>
		  </div>
	  </div>
</div>


	


<!---->
<div class="footer">
	
	 <div class="container">
		 <p>欢迎来到小罗博客<a style="margin-left: 20px;" target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index">备案号：粤ICP备18091111号-1</a></p>
	 </div>
</div>	
