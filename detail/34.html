<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>

<!-- Mirrored from blog.dev.3d66.com/detail/34.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 08 Jul 2025 08:22:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<title>【微信开发】 模板消息发送 - 小罗博客</title>
	<link href="../public/Home/css/bootstrap.css" rel='stylesheet' type='text/css' />
	<link href="../public/Home/css/style.css" rel='stylesheet' type='text/css' />
	<link href="../public/Home/css/base.css" rel='stylesheet' type='text/css' />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="【微信开发】 模板消息发送 - 【微信开发】 模板消息发送 - 小罗博客" />
	<meta name="description" content="【微信开发】 模板消息发送 - 【微信开发】 模板消息发送 - 小罗博客" />
	<!----webfonts---->
		<!----//webfonts---->
		  <script src="../public/Home/js/jquery.min.js"></script>
		<!--end slider -->
		<!--script-->
<!--/script-->
<script type="text/javascript">
			jQuery(document).ready(function($) {
				$(".scroll").click(function(event){		
					event.preventDefault();
					$('html,body').animate({scrollTop:$(this.hash).offset().top},900);
				});
			});
</script>
<!---->

</head>
<body>
<!---header---->			
<div class="header">  
	<div class="header_top">
		<div class="container">
			<div class="header_top_l">
				<p>Hi！欢迎来到 <span class="author">咖啡屋的少年（小罗）</span> 的博客<span class="qq_group">技术交流QQ群：上海php（592152335）、代码改变世界（453011886）</span></p>
			</div>
			<div class="header_top_r">
				<!-- <p>
					<a href="/login.html">登录</a>
					<a href="/register.html">注册</a>
				</p> -->
			</div>
		</div>
	</div>
	 <div class="container" style="margin-bottom:20px">
		  <div class="logo">
			  <a href="index.html"><img src="../public/Home/images/logo.png" title="" /></a>
		  </div>
			 <!---start-top-nav---->
			 <div class="top-menu">
				 
				  <span class="menu"> </span>
				   <ul>
						<li class="active"><a href="../index.html">首页</a></li>
						<li ><a href="../list/PHP.html">PHP</a></li>
						<li ><a href="../list/HTML.html">前端</a></li>
						<li ><a href="../list/linux.html">Linux</a></li>
						<li ><a href="../list/Seo.html">SEO</a></li>
						<li ><a href="../list/mysql.html">MySql</a></li>
						<li ><a href="../list/redis.html">Redis</a></li>
						<li ><a href="../list/Other.html">其他</a></li>
						<div class="clearfix"> </div>
				 </ul>
			 </div>
			 <div class="clearfix"></div>
					<script>
					$("span.menu").click(function(){
						$(".top-menu ul").slideToggle("slow" , function(){
						});
					});
					</script>
				<!---//End-top-nav---->					
	 </div>
</div>

    
<!--/header-->
<div class="content">
	 <div class="container">
		 <div class="content-grids">
			 <div class="col-md-8 content-main">
				 <div class="content-grid">
				 	<h4 class="detail-title">【微信开发】 模板消息发送</h4>
				 	<div class="detail-time">
				 		<p class="post-info-time">2017-09-16 13:14:24 <span>依然范儿特西</span>阅读(0) <span>点赞(0)</span> <span>评论(0)</span></p>
				 	</div>
				 					 		<p class="reprint">本文为转载文章，如有侵权，请联系博主。原文链接：<a href="http://www.cnblogs.com/richerdyoung/p/6917613.html" target="_black">http://www.cnblogs.com/richerdyoung/p/6917613.html</a></p>
				 						<div class="detail_div">
						<p>1 &#x767B;&#x5F55;&#x5FAE;&#x4FE1;&#x516C;&#x4F17;&#x5E73;&#x53F0; &#xFF1A;&#xA0;https://mp.weixin.qq.com/ &#xA0;, &#x5DE6;&#x4FA7;&#x6A21;&#x677F;&#x6D88;&#x606F;&#x3002;&#x4ECE;&#x6A21;&#x677F;&#x5E93;&#x9009;&#x62E9;&#x4F60;&#x6240;&#x9700;&#x8981;&#x7684;&#x6A21;&#x677F;&#xFF0C;&#x83B7;&#x53D6;&#x6A21;&#x677F;ID&#xA0;</p>
<p><img src="../../images2015.cnblogs.com/blog/1103071/201705/1103071-20170529112023571-1551082777.html" alt="">&#xA0; &#xA0;<img src="../../images2015.cnblogs.com/blog/1103071/201705/1103071-20170529112142430-2047744296.html" alt=""></p>
<p>&#xA0;</p>
<p>&#xA0;2 &#xA0;&#x5217;&#x8868;&#x6700;&#x53F3;&#x4FA7;&#xFF0C;&#x8FDB;&#x5165; &#x8BE6;&#x60C5;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230; &#x8BF7;&#x6C42;&#x7684;&#x53C2;&#x6570;&#x683C;&#x5F0F;&#x4FE1;&#x606F;&#x3002;PHP&#x5C01;&#x88C5;&#x65F6;&#x5019;data &#x6570;&#x636E;&#x8981;&#x4E25;&#x683C;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x6765;&#x64CD;&#x4F5C;</p>
<p>&#xA0;</p>
<p><img src="../../images2015.cnblogs.com/blog/1103071/201705/1103071-20170529112211774-1751854885.html" alt=""></p>
<p>&#xA0;</p>
<p>&#xA0;3 &#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A; &#x8BBF;&#x95EE;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x7684; test&#x65B9;&#x6CD5; &#x5373;&#x53EF;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5; &#xFF08;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x7ECF;&#x8FC7;&#x6211;&#x4EB2;&#x6D4B;&#xFF0C;&#x53EF;&#x7528;&#xFF09;</p>
<div class="cnblogs_code">
<pre>&lt;?<span style="color: #000000">php

</span><span style="color: #008000">//</span><span style="color: #008000"> +----------------------------------------------------------------------
// | Todo: &#x6A21;&#x677F;&#x6D88;&#x606F;&#x53D1;&#x9001;
// +----------------------------------------------------------------------
// | Author: &#x4F9D;&#x7136;&#x8303;&#x513F;&#x7279;&#x897F; &#xFF1A; richerdyoung@foxmail.com
// +----------------------------------------------------------------------</span>
<span style="color: #000000">
namespace Wechat\Controller;
</span><span style="color: #0000ff">use</span><span style="color: #000000"> Wechat\Controller\WechatController;

</span><span style="color: #0000ff">class</span> PushController <span style="color: #0000ff">extends</span><span style="color: #000000"> WechatController {
    
    </span><span style="color: #008000">/*</span><span style="color: #008000">*
     * &#x53D1;&#x9001;post&#x8BF7;&#x6C42;
     * @param string $url
     * @param string $param
     * @return bool|mixed
     </span><span style="color: #008000">*/</span>
    <span style="color: #0000ff">function</span> request_post(<span style="color: #800080">$url</span> = &apos;&apos;, <span style="color: #800080">$param</span> = &apos;&apos;<span style="color: #000000">)
    {
        </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">empty</span>(<span style="color: #800080">$url</span>) || <span style="color: #0000ff">empty</span>(<span style="color: #800080">$param</span><span style="color: #000000">)) {
            </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span><span style="color: #000000">;
        }
        </span><span style="color: #800080">$postUrl</span> = <span style="color: #800080">$url</span><span style="color: #000000">;
        </span><span style="color: #800080">$curlPost</span> = <span style="color: #800080">$param</span><span style="color: #000000">;
        </span><span style="color: #800080">$ch</span> = curl_init(); <span style="color: #008000">//</span><span style="color: #008000">&#x521D;&#x59CB;&#x5316;curl</span>
        curl_setopt(<span style="color: #800080">$ch</span>, CURLOPT_URL, <span style="color: #800080">$postUrl</span>); <span style="color: #008000">//</span><span style="color: #008000">&#x6293;&#x53D6;&#x6307;&#x5B9A;&#x7F51;&#x9875;</span>
        curl_setopt(<span style="color: #800080">$ch</span>, CURLOPT_HEADER, 0); <span style="color: #008000">//</span><span style="color: #008000">&#x8BBE;&#x7F6E;header</span>
        curl_setopt(<span style="color: #800080">$ch</span>, CURLOPT_RETURNTRANSFER, 1); <span style="color: #008000">//</span><span style="color: #008000">&#x8981;&#x6C42;&#x7ED3;&#x679C;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x4E14;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x4E0A;</span>
        curl_setopt(<span style="color: #800080">$ch</span>, CURLOPT_POST, 1); <span style="color: #008000">//</span><span style="color: #008000">post&#x63D0;&#x4EA4;&#x65B9;&#x5F0F;</span>
        curl_setopt(<span style="color: #800080">$ch</span>, CURLOPT_POSTFIELDS, <span style="color: #800080">$curlPost</span><span style="color: #000000">);
        </span><span style="color: #800080">$data</span> = curl_exec(<span style="color: #800080">$ch</span>); <span style="color: #008000">//</span><span style="color: #008000">&#x8FD0;&#x884C;curl</span>
        curl_close(<span style="color: #800080">$ch</span><span style="color: #000000">);
        </span><span style="color: #0000ff">return</span> <span style="color: #800080">$data</span><span style="color: #000000">;
    }
 
 
    </span><span style="color: #008000">/*</span><span style="color: #008000">*
     * &#x53D1;&#x9001;get&#x8BF7;&#x6C42;
     * @param string $url
     * @return bool|mixed
     </span><span style="color: #008000">*/</span>
    <span style="color: #0000ff">function</span> request_get(<span style="color: #800080">$url</span> = &apos;&apos;<span style="color: #000000">)
    {
        </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">empty</span>(<span style="color: #800080">$url</span><span style="color: #000000">)) {
            </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span><span style="color: #000000">;
        }
        </span><span style="color: #800080">$ch</span> =<span style="color: #000000"> curl_init();
        curl_setopt(</span><span style="color: #800080">$ch</span>, CURLOPT_URL, <span style="color: #800080">$url</span><span style="color: #000000">);
        curl_setopt(</span><span style="color: #800080">$ch</span>, CURLOPT_RETURNTRANSFER, 1<span style="color: #000000">);
        </span><span style="color: #800080">$data</span> = curl_exec(<span style="color: #800080">$ch</span><span style="color: #000000">);
        curl_close(</span><span style="color: #800080">$ch</span><span style="color: #000000">);
        </span><span style="color: #0000ff">return</span> <span style="color: #800080">$data</span><span style="color: #000000">;
    }
    
     </span><span style="color: #008000">/*</span><span style="color: #008000">*
     * @param $appid
     * @param $appsecret
     * @return mixed
     * &#x83B7;&#x53D6;token
     </span><span style="color: #008000">*/</span>
    <span style="color: #0000ff">public</span> <span style="color: #0000ff">function</span><span style="color: #000000"> get_token(){
        </span><span style="color: #800080">$appid</span> = &apos;&apos;<span style="color: #000000">;
        </span><span style="color: #800080">$secret</span> = &quot;&quot;<span style="color: #000000">;
        </span><span style="color: #800080">$url2</span> = &quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=&quot; . <span style="color: #800080">$appid</span> . &quot;&amp;secret=&quot; . <span style="color: #800080">$secret</span> . &quot;&quot;<span style="color: #000000">;
        </span><span style="color: #800080">$result</span> = json_decode(<span style="color: #008080">file_get_contents</span>(<span style="color: #800080">$url2</span>),<span style="color: #0000ff">true</span><span style="color: #000000">);
        </span><span style="color: #800080">$access_token</span> = <span style="color: #800080">$result</span>[&apos;access_token&apos;<span style="color: #000000">];
        </span><span style="color: #0000ff">return</span>  <span style="color: #800080">$access_token</span><span style="color: #000000">;
    }
   
    
    </span><span style="color: #0000ff">public</span> <span style="color: #0000ff">function</span><span style="color: #000000"> test(){
&#x3000;&#x3000;&#x3000;&#x3000;&#x3000;</span><span style="color: #008000">//</span><span style="color: #008000">openid&#x3000;</span>
        <span style="color: #800080">$touser</span> = <span style="color: #800080">$user_mes</span>[&apos;wx_openid&apos;<span style="color: #000000">];
        </span><span style="color: #008000">//</span><span style="color: #008000">&#x83B7;&#x53D6;token</span>
        <span style="color: #800080">$access_token</span> = <span style="color: #800080">$this</span>-&gt;<span style="color: #000000">get_token();
&#x3000;&#x3000;&#x3000;&#x3000;</span><span style="color: #008000">//</span><span style="color: #008000">&#x6A21;&#x677F;ID</span>
        <span style="color: #800080">$template_id</span> = &apos;&apos;<span style="color: #000000">; 
        </span><span style="color: #800080">$url</span> = &quot;www.baidu.com&quot;<span style="color: #000000">;
        </span><span style="color: #800080">$data</span>=<span style="color: #0000ff">array</span><span style="color: #000000">(
                </span>&apos;first&apos;=&gt;<span style="color: #0000ff">array</span>(&apos;value&apos;=&gt;<span style="color: #008080">urlencode</span>(&quot;&#x606D;&#x559C;&#x4F60;&#x54E6;&#xFF01;&quot;),&apos;color&apos;=&gt;&quot;#743A3A&quot;),
                &apos;keyword1&apos;=&gt;<span style="color: #0000ff">array</span>(&apos;value&apos;=&gt;&apos;22&apos;,&apos;color&apos;=&gt;&apos;#EEEEEE&apos;),
                &apos;keyword2&apos;=&gt;<span style="color: #0000ff">array</span>(&apos;value&apos;=&gt;&apos;33&apos;,&apos;color&apos;=&gt;&apos;#FFFFFF&apos;),
                &apos;remark&apos;=&gt;<span style="color: #0000ff">array</span>(&apos;value&apos;=&gt;&apos;33&apos;,&apos;color&apos;=&gt;&apos;#FFFFFF&apos;<span style="color: #000000">)
        );
        </span><span style="color: #800080">$res</span> = <span style="color: #800080">$this</span>-&gt;Send(<span style="color: #800080">$touser</span>, <span style="color: #800080">$template_id</span>, <span style="color: #800080">$url</span>, <span style="color: #800080">$data</span>, <span style="color: #800080">$access_token</span><span style="color: #000000">);
        
        </span><span style="color: #008080">print_r</span>(<span style="color: #800080">$res</span><span style="color: #000000">);
    }

       </span><span style="color: #008000">/*</span><span style="color: #008000">*
     * &#x53D1;&#x9001;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6A21;&#x677F;&#x6D88;&#x606F;
     * @param $touser  
     * @param $template_id
     * @param $url
     * @param $data
     * @param string $topcolor
     * @return bool
     </span><span style="color: #008000">*/</span>
    <span style="color: #0000ff">public</span> <span style="color: #0000ff">function</span> Send(<span style="color: #800080">$touser</span>, <span style="color: #800080">$template_id</span>, <span style="color: #800080">$url</span>, <span style="color: #800080">$data</span>, <span style="color: #800080">$access_token</span>, <span style="color: #800080">$topcolor</span> = &apos;#7B68EE&apos;<span style="color: #000000">)
    {   
            
        </span><span style="color: #800080">$template</span> = <span style="color: #0000ff">array</span><span style="color: #000000">(
            </span>&apos;touser&apos; =&gt; <span style="color: #800080">$touser</span>,  <span style="color: #008000">//</span><span style="color: #008000">openid</span>
            &apos;template_id&apos; =&gt; <span style="color: #800080">$template_id</span>,
            &apos;url&apos; =&gt; <span style="color: #800080">$url</span>,
            &apos;topcolor&apos; =&gt; <span style="color: #800080">$topcolor</span>,
            &apos;data&apos; =&gt; <span style="color: #800080">$data</span><span style="color: #000000">
        );
        </span><span style="color: #800080">$json_template</span> = json_encode(<span style="color: #800080">$template</span><span style="color: #000000">);
        
        </span><span style="color: #800080">$url</span> = &quot;https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=&quot;.<span style="color: #800080">$access_token</span><span style="color: #000000">;
        </span><span style="color: #800080">$dataRes</span> = <span style="color: #800080">$this</span>-&gt;request_post(<span style="color: #800080">$url</span>, <span style="color: #008080">urldecode</span>(<span style="color: #800080">$json_template</span><span style="color: #000000">));
        </span><span style="color: #0000ff">if</span> (<span style="color: #800080">$dataRes</span>[&apos;errcode&apos;] == 0<span style="color: #000000">) {
            </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span><span style="color: #000000">;
        } </span><span style="color: #0000ff">else</span><span style="color: #000000"> {
            </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span><span style="color: #000000">;
        }
    }
    
    


}</span></pre>
</div>
<p>&#xA0;</p>					</div> 
				 </div>
			  </div>
			<div class="col-md-4 content-right">
			  	 <div class="recent">
					 <h3>站内搜索</h3>
					 <div class="search">
						 <form action="http://blog.dev.3d66.com/search.html" method="get">
						 <input type="text" name="keywords" placeholder="请输入关键字" required="">
						 <input type="submit" value=""/>
						 </form>
					 </div>
				 </div>
				 <div class="recent">
					 <h3>热门文章</h3>
					 <ul>
													<li><a href="1.html">【go】用Golang的 http 包建立 Web 服务器</a></li>
													<li><a href="2.html">【go】go语言socket通信样例</a></li>
													<li><a href="3.html">【linux】Centos下登陆mysql报错#1045 - A</a></li>
													<li><a href="4.html">【Linux】 ftp  主动被动模式</a></li>
													<li><a href="5.html">【linux】安装rar，并解压被压缩成多个rar的文件</a></li>
													<li><a href="7.html">【Redis】php+redis实现消息队列</a></li>
													<li><a href="9.html">【PHP】 php实现字符串反转：支持中英文</a></li>
													<li><a href="11.html">【Laravel】Mac下玩转Laravel</a></li>
													<li><a href="12.html">【PHP】 判断是否微信内置浏览器</a></li>
													<li><a href="13.html">【Base64】用 js 编 解 码 base64</a></li>
											 </ul>
				 </div>
				 <div class="recent">
					 <h3>推荐文章</h3>
					 <ul>
					 								<li><a href="1.html">【go】用Golang的 http 包建立 Web 服务器</a></li>
													<li><a href="2.html">【go】go语言socket通信样例</a></li>
													<li><a href="3.html">【linux】Centos下登陆mysql报错#1045 - A</a></li>
													<li><a href="5.html">【linux】安装rar，并解压被压缩成多个rar的文件</a></li>
													<li><a href="6.html">【Linux】WinSCP普通用户登录sftp后切换到root权</a></li>
													<li><a href="8.html">【mysql】mysql front 提示Access viol</a></li>
													<li><a href="10.html">【短信接口】阿里大于迁移到阿里云之后使用方法</a></li>
													<li><a href="12.html">【PHP】 判断是否微信内置浏览器</a></li>
													<li><a href="14.html">【ecshop】调用购物车商品数量</a></li>
													<li><a href="16.html">【Twitter接口】网站嵌入推特信息</a></li>
											 </ul>
				 </div>
				 <div class="recent">
					 <h3>友情链接</h3>
					 <ul>
						<li><a href="https://www.zhaorui.info/" target="_blank">肇锐博客</a></li>
						<li><a href="https://www.fujieace.com/" target="_blank">付杰博客</a></li>
						<li><a href="http://www.cnblogs.com/richerdyoung/" target="_blank">依然范儿特西博客</a></li>
					 </ul>
				 </div>
				 <div class="clearfix"></div>
			  </div>
		  </div>
	  </div>
</div>


	


<!---->
<div class="footer">
	
	 <div class="container">
		 <p>欢迎来到小罗博客<a style="margin-left: 20px;" target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index">备案号：粤ICP备18091111号-1</a></p>
	 </div>
</div>	
